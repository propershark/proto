<!DOCTYPE html>
<html>
  <head>
    <title>Proper Shark Protocol</title>
    <link href='styles/normalize.css' rel='stylesheet'>
    <link href='styles/main.css' rel='stylesheet'>
    <link crossorigin='anonymous' href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' integrity='sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN' rel='stylesheet'>
  </head>
  <body>
    <div class='container'>
      <nav class='nav'>
        <h1>Proper Shark Protocol</h1>
        <ul>
          <li>
            <a href='#timetable_service_times'>
              Timetable.service_times
            </a>
          </li>
          <li>
            <a href='#timetable_visits_after'>
              Timetable.visits_after
            </a>
          </li>
          <li>
            <a href='#timetable_visits_before'>
              Timetable.visits_before
            </a>
          </li>
          <li>
            <a href='#timetable_visits_between'>
              Timetable.visits_between
            </a>
          </li>
        </ul>
      </nav>
      <div class='protocol'>
        <div class='proto-action public'>
          <div class='proto-title' id='timetable_service_times'>
            <div class='proto-links'>
              <a href='https://github.com/propershark/proto/issues/1' target='_blank'>
                <span class='fa fa-lg fa-comments-o'></span>
              </a>
            </div>
            <pre>Timetable.service_times</pre>
            <div class='proto-meta'>
              <span class='proto-meta-record'><span class='proto-meta-record-key'>since</span>:
                <span class='proto-meta-record-value'>v0.1</span>
              </span>
              <span class='proto-meta-record'><span class='proto-meta-record-key'>accessibility</span>:
                <span class='proto-meta-record-value'>public</span>
              </span>
              <span class='proto-meta-record'><span class='proto-meta-record-key'>minimum role</span>:
                <span class='proto-meta-record-value'>consumer</span>
              </span>
            </div>
          </div>
          <div class='proto-call-spec'>
            <pre>timetable.service_times(station : String, route : String)            <br>-> [(date-of-service, [((start-time, end-time), visit-interval), ...]), ...]</pre>
          </div>
          <div class='proto-description'>
            <p>If the result list contains no entries, an empty array will be returned.</p>
          </div>
          <div class='proto-samples'>
            <ul class='proto-sample-select'>
              <input checked data-content-target='proto_sample_timetable_service_times_Default' id='timetable_service_times_Default' name='timetable_service_times' type='radio'>
              <label for='timetable_service_times_Default'>Default</label>
              <input data-content-target='proto_sample_timetable_service_times_Commented' id='timetable_service_times_Commented' name='timetable_service_times' type='radio'>
              <label for='timetable_service_times_Commented'>Commented</label>
            </ul>
            <div class='proto-sample' id='proto_sample_timetable_service_times_Default'>
              <div class='proto-sample-content'>
                <div class='request'>
                  <pre><code>timetable.service_times('BUS123', '1B')</code></pre>
                </div>
                <div class='response'>
                  <pre><code>[&#x000A;  (20170325, [&#x000A;      ((06:45:00, 07:50:00), 00:00:10),&#x000A;      ((08:00:00, 16:55:00), 00:00:05),&#x000A;      ((17:00:00, 22:50:00), 00:00:10)&#x000A;    ]&#x000A;  ),&#x000A;  (20170326, [&#x000A;      ((00:00:00, 03:00:00), 00:00:30),&#x000A;      ((09:00:00, 22:00:00), 00:00:30),&#x000A;      ((22:00:00, 03:00:00), 00:00:30)&#x000A;    ]&#x000A;  ),&#x000A;  (20170327, []),&#x000A;  (20170328, [&#x000A;      ((06:45:00, 07:50:00), 00:00:10),&#x000A;      ((08:00:00, 16:55:00), 00:00:05),&#x000A;      ((17:00:00, 22:50:00), 00:00:10)&#x000A;    ]&#x000A;  )&#x000A;  ...&#x000A;]</code></pre>
                </div>
              </div>
            </div>
            <div class='proto-sample' id='proto_sample_timetable_service_times_Commented'>
              <div class='proto-sample-content'>
                <div class='request'>
                  <pre><code>timetable.service_times('BUS123', '1B')</code></pre>
                </div>
                <div class='response'>
                  <pre><code>// Array of service records.&#x000A;// This array will always contain 7 entries, each one representing a day of the&#x000A;// week. The first entry will always correspond to the current date according&#x000A;// to the RPC provider.&#x000A;// In this example, the first entry is a Saturday. The final entry would be the&#x000A;// following Friday.&#x000A;[&#x000A;  // Service record&#x000A;  (&#x000A;    // Date of service entry&#x000A;    20170325, // = Saturday&#x000A;    // Array of visit intervals&#x000A;    [&#x000A;      // Interval record&#x000A;      (&#x000A;        // time range of visit interval&#x000A;        (06:45:00, 07:50:00),&#x000A;        // visit interval&#x000A;        00:00:10&#x000A;      ),&#x000A;      // mid-day changes to a service's visit interval are represented as&#x000A;      // separate elements in the intervals array.&#x000A;      ((08:00:00, 16:55:00), 00:00:05), // = 8am- 4:55pm, every  5 minutes&#x000A;      ((17:00:00, 22:50:00), 00:00:10)  // = 5pm-10:50pm, every 10 minutes&#x000A;    ]&#x000A;  ),&#x000A;&#x000A;  // Dates with only one interval record will still contain that record in an&#x000A;  // array to maintain consistency.&#x000A;  (&#x000A;    20170326, // = Sunday&#x000A;    [&#x000A;      ((00:00:00, 03:00:00), 00:00:30),  // = 5pm-10:50pm, every 10 minutes&#x000A;      ((09:00:00, 22:00:00), 00:00:30),&#x000A;      // Intervals that wrap the midnight boundary represent the end of their&#x000A;      // time range as a duration since the most recent midnight. This *should*&#x000A;      // never be later than the start of the time range.&#x000A;      ((22:00:00, 03:00:00), 00:00:30)  // = 5pm-10:50pm, every 10 minutes&#x000A;    ]&#x000A;  ),&#x000A;&#x000A;  // For consistency, dates on which no service is provided will contain a blank&#x000A;  // array value.&#x000A;  (&#x000A;    20170327, // = Monday&#x000A;    []&#x000A;  ),&#x000A;&#x000A;  // Even if multiple dates contain the same interval records, they will be&#x000A;  // listed as distinct service records. It is the client's responsibility to&#x000A;  // group these records by date if desired.&#x000A;  (&#x000A;    20170328, // = Tuesday&#x000A;    [&#x000A;      ((06:45:00, 07:50:00), 00:00:10),&#x000A;      ((08:00:00, 16:55:00), 00:00:05),&#x000A;      ((17:00:00, 22:50:00), 00:00:10)&#x000A;    ]&#x000A;  )&#x000A;&#x000A;  ...&#x000A;]</code></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class='proto-action public'>
          <div class='proto-title' id='timetable_visits_after'>
            <div class='proto-links'>
            </div>
            <pre>Timetable.visits_after</pre>
            <div class='proto-meta'>
              <span class='proto-meta-record'><span class='proto-meta-record-key'>since</span>:
                <span class='proto-meta-record-value'>v0.1</span>
              </span>
              <span class='proto-meta-record'><span class='proto-meta-record-key'>accessibility</span>:
                <span class='proto-meta-record-value'>public</span>
              </span>
              <span class='proto-meta-record'><span class='proto-meta-record-key'>minimum role</span>:
                <span class='proto-meta-record-value'>consumer</span>
              </span>
            </div>
          </div>
          <div class='proto-call-spec'>
            <pre>timetable.visits_after(station : String, start : DateTime, route : String?, limit : Int)            <br>-> [(eta, etd, route_short_name, headsign)...]</pre>
          </div>
          <div class='proto-description'>
            <p>Returns an ordered list of estimated departures from the given <code>station</code>, where the departure time is at or after <code>start</code>. The arrival time of the visit may be before <code>start</code>, depending on the scheduled <a href="https://en.wikipedia.org/wiki/Terminal_dwell_time">dwell time</a> of the underlying <code>stop_time</code>.</p>
            <p>The <code>route</code> parameter is optional. When given, it is expect to match the <code>short_name</code> of a route that the agency provides. In this case, visits from other routes are excluded from the result list. When omitted, all visits (regardless of route) are included in the result list. To retrieve visits for only a select set of routes, make a separate call for each route.</p>
            <p>Note that <code>limit</code> is only an upper-bound on the number of results that may be returned. If fewer than <code>limit</code> visits are active after <code>start</code>, the result list will only contain that many entries. That is, the size of the result list is <code>min(active_visits, limit)</code>.</p>
            <p>If the result list contains no entries, an empty array will be returned.</p>
          </div>
          <div class='proto-samples'>
            <ul class='proto-sample-select'>
              <input checked data-content-target='proto_sample_timetable_visits_after_Without-Route-Parameter' id='timetable_visits_after_Without-Route-Parameter' name='timetable_visits_after' type='radio'>
              <label for='timetable_visits_after_Without-Route-Parameter'>Without Route Parameter</label>
              <input data-content-target='proto_sample_timetable_visits_after_With-Route-Parameter' id='timetable_visits_after_With-Route-Parameter' name='timetable_visits_after' type='radio'>
              <label for='timetable_visits_after_With-Route-Parameter'>With Route Parameter</label>
            </ul>
            <div class='proto-sample' id='proto_sample_timetable_visits_after_Without-Route-Parameter'>
              <div class='proto-sample-content'>
                <div class='request'>
                  <pre><code>timetable.visits_after('BUS215', '20170130 06:40:00', 10)</code></pre>
                </div>
                <div class='response'>
                  <pre><code>[&#x000A;  ['20170130 06:45:00','20170130 06:45:00','1B','to Walmart'],&#x000A;  ['20170130 06:35:00','20170130 06:45:00','5','to Salisbury'],&#x000A;  ['20170130 06:50:00','20170130 06:50:00','1B','to Walmart']&#x000A;]</code></pre>
                </div>
              </div>
            </div>
            <div class='proto-sample' id='proto_sample_timetable_visits_after_With-Route-Parameter'>
              <div class='proto-sample-content'>
                <div class='request'>
                  <pre><code>timetable.visits_after('BUS215', '20170130 06:40:00', '1B', 10)</code></pre>
                </div>
                <div class='response'>
                  <pre><code>[&#x000A;  ['20170130 06:45:00','20170130 06:45:00','1B','to Walmart'],&#x000A;  ['20170130 06:50:00','20170130 06:50:00','1B','to Walmart']&#x000A;]</code></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class='proto-action public'>
          <div class='proto-title' id='timetable_visits_before'>
            <div class='proto-links'>
            </div>
            <pre>Timetable.visits_before</pre>
            <div class='proto-meta'>
              <span class='proto-meta-record'><span class='proto-meta-record-key'>since</span>:
                <span class='proto-meta-record-value'>v0.1</span>
              </span>
              <span class='proto-meta-record'><span class='proto-meta-record-key'>accessibility</span>:
                <span class='proto-meta-record-value'>public</span>
              </span>
              <span class='proto-meta-record'><span class='proto-meta-record-key'>minimum role</span>:
                <span class='proto-meta-record-value'>consumer</span>
              </span>
            </div>
          </div>
          <div class='proto-call-spec'>
            <pre>timetable.visits_before(station : String, end : DateTime, route : String?, limit : Int)            <br>-> [(eta, etd, route_short_name, headsign)...]</pre>
          </div>
          <div class='proto-description'>
            <p>Returns an ordered list of estimated departures from the given <code>station</code>, where the departure time is at or before <code>end</code>. Visits are ordered descending by departure time. Note that the arrival times may not appear sorted, depending on the scheduled <a href="https://en.wikipedia.org/wiki/Terminal_dwell_time">dwell time</a> for the underlying <code>stop_time</code>.</p>
            <p>The <code>route</code> parameter is optional. When given, it is expect to match the <code>short_name</code> of a route that the agency provides. In this case, visits from other routes are excluded from the result list. When omitted, all visits (regardless of route) are included in the result list. To retrieve visits for only a select set of routes, make a separate call for each route.</p>
            <p>Note that <code>limit</code> is only an upper-bound on the number of results that may be returned. If fewer than <code>limit</code> visits are active before <code>end</code>, the result list will only contain that many entries. That is, the size of the result list is <code>min(active_visits, limit)</code>.</p>
            <p>If the result list contains no entries, an empty array will be returned.</p>
          </div>
          <div class='proto-samples'>
            <ul class='proto-sample-select'>
              <input checked data-content-target='proto_sample_timetable_visits_before_Without-Route-Parameter' id='timetable_visits_before_Without-Route-Parameter' name='timetable_visits_before' type='radio'>
              <label for='timetable_visits_before_Without-Route-Parameter'>Without Route Parameter</label>
              <input data-content-target='proto_sample_timetable_visits_before_With-Route-Parameter' id='timetable_visits_before_With-Route-Parameter' name='timetable_visits_before' type='radio'>
              <label for='timetable_visits_before_With-Route-Parameter'>With Route Parameter</label>
            </ul>
            <div class='proto-sample' id='proto_sample_timetable_visits_before_Without-Route-Parameter'>
              <div class='proto-sample-content'>
                <div class='request'>
                  <pre><code>timetable.visits_before('BUS215', '20170130 06:50:00', 10)</code></pre>
                </div>
                <div class='response'>
                  <pre><code>[&#x000A;  ['20170130 06:50:00','20170130 06:50:00','1B','to Walmart']&#x000A;  ['20170130 06:35:00','20170130 06:45:00','5','to Salisbury'],&#x000A;  ['20170130 06:45:00','20170130 06:45:00','1B','to Walmart'],&#x000A;]</code></pre>
                </div>
              </div>
            </div>
            <div class='proto-sample' id='proto_sample_timetable_visits_before_With-Route-Parameter'>
              <div class='proto-sample-content'>
                <div class='request'>
                  <pre><code>timetable.visits_before('BUS215', '20170130 06:50:00', '1B', 10)</code></pre>
                </div>
                <div class='response'>
                  <pre><code>[&#x000A;  ['20170130 06:50:00','20170130 06:50:00','1B','to Walmart']&#x000A;  ['20170130 06:45:00','20170130 06:45:00','1B','to Walmart'],&#x000A;]</code></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class='proto-action public'>
          <div class='proto-title' id='timetable_visits_between'>
            <div class='proto-links'>
              <a href='https://github.com/propershark/timetable_cpp/issues/1' target='_blank'>
                <span class='fa fa-lg fa-comments-o'></span>
              </a>
            </div>
            <pre>Timetable.visits_between</pre>
            <div class='proto-meta'>
              <span class='proto-meta-record'><span class='proto-meta-record-key'>since</span>:
                <span class='proto-meta-record-value'>v0.1</span>
              </span>
              <span class='proto-meta-record'><span class='proto-meta-record-key'>accessibility</span>:
                <span class='proto-meta-record-value'>public</span>
              </span>
              <span class='proto-meta-record'><span class='proto-meta-record-key'>minimum role</span>:
                <span class='proto-meta-record-value'>consumer</span>
              </span>
            </div>
          </div>
          <div class='proto-call-spec'>
            <pre>timetable.visits_between(station : String, start : DateTime, end : DateTime, route : String?, limit : Int)            <br>-> [(eta, etd, route_short_name, headsign)...]</pre>
          </div>
          <div class='proto-description'>
            <p>Returns an ordered list of estimated departures from the given <code>station</code>, where the departure time is within the range <code>[start, end]</code>. The arrival time of the visit may be outside of the given datetime range, depending on the scheduled <a href="https://en.wikipedia.org/wiki/Terminal_dwell_time">dwell time</a> of the underlying <code>stop_time</code>.</p>
            <p>The <code>route</code> parameter is optional. When given, it is expect to match the <code>short_name</code> of a route that the agency provides. In this case, visits from other routes are excluded from the result list. When omitted, all visits (regardless of route) are included in the result list. To retrieve visits for only a select set of routes, make a separate call for each route.</p>
            <p>Note that <code>limit</code> is only an upper-bound on the number of results that may be returned. If fewer than <code>limit</code> visits are active within the given datetime range, the result list will only contain that many entries. That is, the size of the result list is <code>min(active_visits, limit)</code>.</p>
            <p>If the result list contains no entries, an empty array will be returned.</p>
          </div>
          <div class='proto-samples'>
            <ul class='proto-sample-select'>
              <input checked data-content-target='proto_sample_timetable_visits_between_Without-Route-Parameter' id='timetable_visits_between_Without-Route-Parameter' name='timetable_visits_between' type='radio'>
              <label for='timetable_visits_between_Without-Route-Parameter'>Without Route Parameter</label>
              <input data-content-target='proto_sample_timetable_visits_between_With-Route-Parameter' id='timetable_visits_between_With-Route-Parameter' name='timetable_visits_between' type='radio'>
              <label for='timetable_visits_between_With-Route-Parameter'>With Route Parameter</label>
            </ul>
            <div class='proto-sample' id='proto_sample_timetable_visits_between_Without-Route-Parameter'>
              <div class='proto-sample-content'>
                <div class='request'>
                  <pre><code>timetable.visits_between('BUS215', '20170130 06:40:00', '20170130 06:55:00', 10)</code></pre>
                </div>
                <div class='response'>
                  <pre><code>[&#x000A;  ['20170130 06:45:00','20170130 06:45:00','1B','to Walmart'],&#x000A;  ['20170130 06:35:00','20170130 06:45:00','5','to Salisbury'],&#x000A;  ['20170130 06:50:00','20170130 06:50:00','1B','to Walmart']&#x000A;]</code></pre>
                </div>
              </div>
            </div>
            <div class='proto-sample' id='proto_sample_timetable_visits_between_With-Route-Parameter'>
              <div class='proto-sample-content'>
                <div class='request'>
                  <pre><code>timetable.visits_between('BUS215', '20170130 06:40:00', '20170130 06:55:00', '1B', 10)</code></pre>
                </div>
                <div class='response'>
                  <pre><code>[&#x000A;  ['20170130 06:45:00','20170130 06:45:00','1B','to Walmart'],&#x000A;  ['20170130 06:50:00','20170130 06:50:00','1B','to Walmart']&#x000A;]</code></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script crossorigin='anonymous' integrity='sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=' src='https://code.jquery.com/jquery-3.1.1.slim.min.js'></script>
  <script>
    $('.proto-action').each(function() {
      $(this).find('.proto-sample').first().toggleClass("visible");
    });
    
    $('input[type=radio]').change(function() {
      $(this).closest('.proto-action').find(".proto-sample.visible").toggleClass("visible", false);
      $('[id="'+$(this).data('content-target')+'"]').toggleClass("visible", $(this).checked);
    });
  </script>
</html>
